<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Blogs on Dave&#39;s Website</title>
    <link>https://davidmoremad.github.io/blog/index.xml</link>
    <description>Recent content in Blogs on Dave&#39;s Website</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>es-es</language>
    <atom:link href="https://davidmoremad.github.io/blog/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>DNS - Gathering information</title>
      <link>https://davidmoremad.github.io/blog/dns/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://davidmoremad.github.io/blog/dns/</guid>
      <description>&lt;p&gt;Obtención de información de servidores DNS usando tecnicas como Snooping o transferencia de zona.&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;!--toc--&gt;

&lt;hr /&gt;

&lt;h1 id=&#34;zone-transfer&#34;&gt;Zone transfer&lt;/h1&gt;

&lt;p&gt;Una vez detectado el servidor DNS de la pagina se solicita una transferencia de zona (AXFR):&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Using host&lt;/strong&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;  host -t axfr elevenpaths.com 35.10.10.10
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;Using nslookup&lt;/strong&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;  # Obtener DNS server
  set type=ns
  ls
  server dns1.dominio.com
  # Obtener zona
  set type=axfr
  ls dominio.com
&lt;/code&gt;&lt;/pre&gt;

&lt;h1 id=&#34;cache-snooping&#34;&gt;Cache snooping&lt;/h1&gt;

&lt;p&gt;&lt;em&gt;La vulnerabilidad DNS Cache Snooping permite a un atacante realizar peticiones contra un servidor DNS con el fin de conocer que páginas tiene en caché (últimas páginas buscadas o páginas buscadas comunmente). Las peticiones se realizan individualmente, por cada página que se quiera conocer si está en caché o no.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Using nslookup&lt;/strong&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;
  # Obtener DNS server
  set type=ns
  renfe.es
  server ns1.renfe.es

  # Obtener info
  set type=a
  set norecurse
  www.facebook.com
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;Using nmap&lt;/strong&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;nmap -sU -p 53 --script dns-cache-snoop.nse --script-args &#39;dns-cache-snoop.mode=nonrecursive,dns-cache-snoop.domains={facebook.com,twitter.com}&#39; ns1.renfe.es;
&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    
    <item>
      <title>Response Splitting</title>
      <link>https://davidmoremad.github.io/blog/responseSplitting/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://davidmoremad.github.io/blog/responseSplitting/</guid>
      <description>&lt;p&gt;Inyección y modificación de cabeceras y cuerpo de la respuesta en un sitio web.&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;

&lt;p&gt;La vulnerabilidad consiste en inyectar datos, que no han sido validados, en los parámetros que recibe una página. Mediante la inyección de estos parametros podemos modificar no solo el contenido, sino también las cabeceras. Esto se consigue mediante los caracteres CR-LF, correspondientes a retorno de carro y salto de linea.&lt;/p&gt;

&lt;h1 id=&#34;ejemplo&#34;&gt;Ejemplo&lt;/h1&gt;

&lt;h3 id=&#34;parametro-inyectado-como-cookie&#34;&gt;Parametro inyectado como cookie&lt;/h3&gt;

&lt;p&gt;Como vemos, el valor del parameto GET viene reflejado en la respuesta (devuelve HTML).


 
  
  
  
  
    
  

&lt;div class=&#34;figure &#34; &gt;
  
    &lt;a class=&#34;fancybox&#34; href=&#34;https://davidmoremad.github.io/images/blogg/responseSplitting/inj1.jpg&#34; data-fancybox-group=&#34;group:travel&#34;&gt;
  
    &lt;img class=&#34;fig-img&#34; src=&#34;https://davidmoremad.github.io/images/blogg/responseSplitting/inj1.jpg&#34; &gt;
  
    &lt;/a&gt;
  
  
&lt;/div&gt;
&lt;/p&gt;

&lt;h3 id=&#34;inyectar-cabecera&#34;&gt;Inyectar cabecera&lt;/h3&gt;

&lt;p&gt;Lo que haremos entonces será realizar un salto de linea para introducir nuevas cabeceras que nosotros queramos, como por ejemplo indicar que devuelva un texto plano en lugar de un HTML.
Para ello usaremos el salto de linea (&lt;strong&gt;%0d%0a&lt;/strong&gt;).


 
  
  
  
  
    
  

&lt;div class=&#34;figure &#34; &gt;
  
    &lt;a class=&#34;fancybox&#34; href=&#34;https://davidmoremad.github.io/images/blogg/responseSplitting/inj2.jpg&#34; data-fancybox-group=&#34;group:travel&#34;&gt;
  
    &lt;img class=&#34;fig-img&#34; src=&#34;https://davidmoremad.github.io/images/blogg/responseSplitting/inj2.jpg&#34; &gt;
  
    &lt;/a&gt;
  
  
&lt;/div&gt;
&lt;/p&gt;

&lt;h3 id=&#34;inyectar-contenido&#34;&gt;Inyectar contenido&lt;/h3&gt;

&lt;p&gt;Inyectando un doble salto de linea accedemos al cuerpo de la respuesta.


 
  
  
  
  
    
  

&lt;div class=&#34;figure &#34; &gt;
  
    &lt;a class=&#34;fancybox&#34; href=&#34;https://davidmoremad.github.io/images/blogg/responseSplitting/inj3.jpg&#34; data-fancybox-group=&#34;group:travel&#34;&gt;
  
    &lt;img class=&#34;fig-img&#34; src=&#34;https://davidmoremad.github.io/images/blogg/responseSplitting/inj3.jpg&#34; &gt;
  
    &lt;/a&gt;
  
  
&lt;/div&gt;
&lt;/p&gt;</description>
    </item>
    
  </channel>
</rss>